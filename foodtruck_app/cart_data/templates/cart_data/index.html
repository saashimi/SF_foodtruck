<html>
{% load static %}
{% load leaflet_tags %}
    <head>
        {% leaflet_js %}
        {% leaflet_css %}
        <script type="text/javascript" src="{{ STATIC_URL }} static/js/jquery-3.1.1.min.js"></script>
        <script type="text/javascript" src="{{ STATIC_URL }} static/js/leaflet.ajax.min.js"></script>
        <style media="screen">
            #food_cart { width:100%; height:100%}
        </style>
    </head>
    <body>

        <script type="text/javascript">
            function map_init_basic(map, options) {
                var geojsonPointLayer = new L.GeoJSON.AJAX("{% url 'cart_db_data' %}", {
                    onEachFeature:function(feature, layer) {
                        layer.bindPopup(feature.properties.applicant.toString());
                    }
                });
                geojsonPointLayer.addTo(map);
            
            var clickCircle;
            function onMapClick(e) {
                console.log("we're in here!");
                if (clickCircle != undefined) {
                    map.removeLayer(clickCircle);
                } 
                    clickCircle = L.circle(e.latlng, 1609 * .5, {
                    color: 'blue',
                    fillOpacity: 0,
                    opacity: 0.5,
                    zIndex: 999,
                    }).addTo(map);
            }
            
            map.on('click', onMapClick);

            }


        </script>

        {% leaflet_map "food_cart" callback="map_init_basic" %}

    </body>
</html>